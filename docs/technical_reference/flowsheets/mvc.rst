Mechanical Vapor Compression
============================

Introduction
------------

Mechanical vapor compression (MVC) is an energy recovery system that recycles waste heat from working fluids (usually steam),
reducing a facility's energy consumption and operational costs. The process works by increasing the
temperature and pressure of waste heat with a compressor and then transferring the excess heat via heat exchangers (HEX), ultimately
generating a concentrated brine stream and a distillate stream.

Implementation
--------------

Figure 1 shows the process flow diagram for MVC where half (default value) of the influent water is pumped into the cold inlet
of a distillate HEX, and the other half is pumped into the cold inlet of a brine HEX. After receiving heat from the HEXs,
the cold side outlets are mixed and sent to the evaporator, which produces steam and brine streams.
The brine is sent to the hot side inlet of the brine HEX, transferring some of its heat to the influent before leaving the system.
Meanwhile, the steam generated by the evaporator is sent to a compressor, increasing the temperature and pressure
of the steam. The amount of energy needed to compress the steam is relatively small compared to the energy saved by
utilizing the recovered waste heat, making this process highly energy efficient. The compressed vapor is recycled back to the
evaporator which helps to produce even more steam. Finally, this distillate is sent to the hot side inlet of the distillate
HEX, transferring some of its heat to the influent before leaving the system. The flowsheet relies
on the following key assumptions:

   * supports steady-state only
   * property package(s) supporting liquid and vapors is provided

.. figure:: ../../_static/flowsheets/mvc.png
    :width: 600
    :align: center

    Figure 1. MVC flowsheet

Documentation for each of the WaterTAP unit models can be found below.
    * `Pressure Changer <https://watertap.readthedocs.io/en/latest/technical_reference/unit_models/pressure_changer.html>`_
    * `Evaporator <https://watertap.readthedocs.io/en/latest/technical_reference/unit_models/evaporator.html>`_
    * `Compressor <https://watertap.readthedocs.io/en/latest/technical_reference/unit_models/compressor.html>`_
    * `Condenser <https://watertap.readthedocs.io/en/latest/technical_reference/unit_models/condenser.html>`_

Documentation for each of the IDAES unit models can be found below.
    * `Feed <https://idaes-pse.readthedocs.io/en/latest/reference_guides/model_libraries/generic/unit_models/feed.html>`_
    * `Heat Exchanger <https://idaes-pse.readthedocs.io/en/latest/reference_guides/model_libraries/generic/unit_models/heat_exchanger.html>`_
    * `Separator <https://idaes-pse.readthedocs.io/en/latest/reference_guides/model_libraries/generic/unit_models/separator.html>`_
    * `Product <https://idaes-pse.readthedocs.io/en/latest/reference_guides/model_libraries/generic/unit_models/product.html>`_
    * `Mixer <https://idaes-pse.readthedocs.io/en/latest/reference_guides/model_libraries/generic/unit_models/mixer.html>`_
    * `Translator <https://idaes-pse.readthedocs.io/en/latest/reference_guides/model_libraries/generic/unit_models/translator.html>`_

Documentation for each of the property models can be found below.
    * `Water <https://watertap.readthedocs.io/en/latest/technical_reference/property_models/water.html>`_
    * `Seawater <https://watertap.readthedocs.io/en/latest/technical_reference/property_models/seawater.html>`_

Documentation for the costing relationships can be found below.
    * `WaterTAP Costing Package <https://watertap.readthedocs.io/en/latest/technical_reference/costing/watertap_costing.html>`_

The objective function is to minimize the levelized cost of water, which can be represented by the following equation
where :math:`Q` represents volumetric flow, :math:`f_{crf}` represents capital recovery factor
:math:`C_{cap,tot}` represents total capital cost, :math:`C_{op,tot}` represents total operating cost, and
:math:`f_{util}` represents the utilization factor:

    .. math::

        LCOW_{Q} = \frac{f_{crf}   C_{cap,tot} + C_{op,tot}}{f_{util} Q}

Degrees of Freedom
------------------
The following variables are initially specified for simulating the MVC flowsheet (i.e., degrees of freedom = 0):
    * feed water conditions (mass flow, mass fractions, temperature, and pressure)
    * feed pump efficiency and pressure change (ΔP)
    * separator split fraction
    * distillate HEX heat transfer coefficient, area, cold-side ΔP, and hot-side ΔP
    * brine HEX heat transfer coefficient, area, cold-side ΔP, and hot-side ΔP
    * evaporator outlet brine temperature and overall heat transfer coefficient
    * compressor efficiency and pressure ratio
    * brine pump efficiency and ΔP
    * distillate pump efficiency and ΔP
    * translator block outlet TDS concentration

Flowsheet Specifications
------------------------

.. csv-table::
   :header: "Description", "Value", "Units"

   "**Feed Water**"
   "Water mass flow","40", ":math:`\text{kg/s}`"
   "TDS mass fraction", "0.1", ":math:`\text{dimensionless}`"
   "Temperature", "298.15", ":math:`\text{K}`"
   "Pressure", "101325", ":math:`\text{Pa}`"

   "**Feed Pump**"
   "Pump efficiency", "0.8", ":math:`\text{dimensionless}`"
   "Pressure change", "7000", ":math:`\text{Pa}`"

   "**Separator**"
   "Total flow split fraction to distillate HEX", "0.5", ":math:`\text{dimensionless}`"

   "**Distillate HEX**"
   "Overall heat transfer coefficient", "2000", ":math:`W/\left(m^2K\right)`"
   "Area", "125", ":math:`\text{m}^2`"
   "Cold-side pressure change", "7000", ":math:`\text{Pa}`"
   "Hot-side pressure change", "7000", ":math:`\text{Pa}`"

   "**Brine HEX**"
   "Overall heat transfer coefficient", "2000", ":math:`W/\left(m^2K\right)`"
   "Area", "125", ":math:`\text{m}^2`"
   "Cold-side pressure change", "7000", ":math:`\text{Pa}`"
   "Hot-side pressure change", "7000", ":math:`\text{Pa}`"

   "**Evaporator**"
   "Outlet brine temperature", "343.15", ":math:`\text{K}`"
   "Overall heat transfer coefficient", "3000", ":math:`W/\left(m^2K\right)`"

   "**Compressor**"
   "Compressor efficiency", "0.8", ":math:`\text{dimensionless}`"
   "Pressure ratio", "1.6", ":math:`\text{dimensionless}`"

   "**Brine Pump**"
   "Pump efficiency", "0.8", ":math:`\text{dimensionless}`"
   "Pressure change", "40000", ":math:`\text{Pa}`"

   "**Distillate Pump**"
   "Pump efficiency", "0.8", ":math:`\text{dimensionless}`"
   "Pressure change", "40000", ":math:`\text{Pa}`"

   "**Translator Block**"
   "Outlet TDS mass flow", "1e-5", ":math:`\text{kg/s}`"
